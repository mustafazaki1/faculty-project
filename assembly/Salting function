Salting PROC USES ECX EBX EDX EAX
call Random32

mov random,EAX

mov ah,42h
mov al,2				; offset from end
mov bx,filehandle
mov cx,0
mov dx,0
int 21h

mov ah,40h				; write to file/device
mov bx,filehandle		; file handle returned by OPEN
mov cx,4				; number of bytes to write
mov dx,offset random	; DX points to the buffer
int 21h


mov ah,42h
mov al,0				; offset from begining
mov bx,filehandle
mov cx,0
mov dx,0
int 21h

Ret
Salting ENDP
